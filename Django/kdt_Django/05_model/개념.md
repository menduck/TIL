# Django Model
- ğŸ‘©â€ğŸ’» [Django Model ì „ì²´ ì‹¤ìŠµíŒŒì¼](./model_practice/)

<p align="center">
<img src = 'https://user-images.githubusercontent.com/39366835/228477058-c1e8b3d8-3f9d-465c-9023-0be7730dd914.PNG'>
</p>

- DBê°€ ì•„ë‹ˆë¼ DBë¥¼ ê´€ë¦¬í•¨
- DBì˜ í…Œì´ë¸”ì„ ì •ì˜í•˜ê³  ë°ì´í„°ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë“¤ì„ ì œê³µ
- DBì˜ ì„¤ê³„ë¥¼ modelíŒŒì¼ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒ

## model í´ë˜ìŠ¤ ì‘ì„±
- ğŸ‘©â€ğŸ’» [model í´ë˜ìŠ¤](./model_practice/articles/models.py)
- ëª¨ë¸ í´ë˜ìŠ¤ëŠ” == í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ

|id|title|content|
|---|---|---|---|
|...|...|...|...|
|...|...|...|...|

```py
# articles/models.py
class Article(models.Model):
    # í•„ë“œ ì´ë¦„(ë³€ìˆ˜ëª…) & ë°ì´í„° íƒ€ì…(ëª¨ë¸ í•„ë“œ í´ë¼ìŠ¤) & ì œì•½ì¡°ê±´
    # idëŠ” djangoê°€ ì•Œì•„ì„œ ì„¤ê³„ í•´ì¤Œ.
    #  CharFiled(): ê¸¸ì´ ì œí•œì´ ìˆëŠ” ë¬¸ìì—´, TextField():ê¸¸ì´ ì œí•œì´ ì—†ëŠ” ë¬¸ìì—´
    title = models.CharField(max_length=10) # ì œëª©ì€ ê¸€ì ì œí•œì„ ë‘¬ì•¼ í•˜ë‹ˆ
    content=models.TextField()
```

- models ëª¨ë“ˆ ì•ˆì— Modelë¼ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ ì‘ì„±
- id í•„ë“œëŠ” ìë™ ìƒì„±
- í´ë˜ìŠ¤ ë³€ìˆ˜ëª… -> í…Œì´ë¸”ì˜ ê° 'í•„ë“œ ì´ë¦„'
- models Field í´ë˜ìŠ¤ -> í…Œì´ë¸” í•„ë“œì˜ 'ë°ì´í„° íƒ€ì…'
- models Field í´ë˜ìŠ¤ì˜ í‚¤ì›Œë“œ ì¸ì(í•„ë“œ ì˜µì…˜)-> í…Œì´ë¸” í•„ë“œì˜ 'ì œì•½ ì¡°ê±´'

### model fileds
[ê³µì‹ë¬¸ì„œ ë°”ë¡œê°€ê¸°](https://docs.djangoproject.com/en/4.1/ref/models/fields/)

- CharField()
    - ê¸¸ì´ì˜ ì œí•œì´ ìˆëŠ” ë¬¸ìì—´ì„ ë„£ì„ë•Œ ì‚¬ìš©
    - max_lengthëŠ” í•„ë“œì˜ ìµœëŒ€ ê¸¸ì´ë¥¼ ê²°ì •í•˜ëŠ” í•„ìˆ˜ ì¸ì
- TextField()
    - ê¸€ìì˜ ìˆ˜ê°€ ë§ì„ ë•Œ ì‚¬ìš©
- DateTimeField()
    - ë‚ ì§œì™€ ì‹œê°„ì„ ë„£ì„ ë•Œ ì‚¬ìš©
    - ì„ íƒ ì¸ì
        - auto_now : ë°ì´í„°ê°€ ì €ì¥ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ í˜„ì¬ ë‚ ì§œì‹œê°„ì„ ì €ì¥, ìˆ˜ì •ì¼ì í•„ë“œì— ì í•©
        - auto_now_add: ë°ì´í„°ê°€ ì²˜ìŒ ìƒì„±ë  ë•Œë§Œ ìë™ìœ¼ë¡œ í˜„ì¬ ë‚ ì§œì‹œê°„ì„ ì €ì¥, ìƒì„±ì¼ìì— ì í•©

## Migrations

<p align="center">
<img src = 'https://user-images.githubusercontent.com/39366835/228477075-736dab12-6251-482b-9313-3fb0db897739.PNG'>
</p>

- Model í´ë˜ìŠ¤ì˜ ë³€ê²½ì‚¬í•­(í•„ë“œ ìƒì„±, ì¶”ê°€ ìˆ˜ì • ë“±)ì„ DBì— ìµœì¢… ë°˜ì˜í•˜ëŠ” ë°©ë²•
### migrations ê³¼ì •

1. makemigrations
- model class(ì´ˆì•ˆ) -> migration íŒŒì¼(ì„¤ê³„ë„)
2. migrate
- migration íŒŒì¼(ì„¤ê³„ë„) -> db.splite3

### migrations í•µì‹¬ ëª…ë ¹ì–´

> $ python manage.py makemigrations

- model classë¥¼ ê¸°ë°˜ì„ ì„¤ê³„ë„(migration) ì‘ì„±

> $ python manage.py migrate

- ë§Œë“¤ì–´ì§„ ì„¤ê³„ë„ë¥¼ DBì— ì „ë‹¬í•˜ì—¬ ë°˜ì˜

#### ì°¸ê³  ëª…ë ¹ì–´

> $ python manage.py showmigrations

- migrations íŒŒì¼ë“¤ì´ migrate ëëŠ”ì§€ ì•ˆëëŠ”ì§€ í™•ì¸í•˜ëŠ” ìš©ë„
- [X] í‘œì‹œê°€ ìˆìœ¼ë©´ migrateê°€ ì™„ë£Œë˜ì—ˆìŒì„ ì˜ë¯¸

> $ python manage.py sqlmigrate ì•± ì•±ë²ˆí˜¸

- í•´ë‹¹ migrations íŒŒì¼ì´ SQLë¬¸ìœ¼ë¡œ ì–´ë–»ê²Œ í•´ì„ ë˜ì–´ DBì— ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ìš©ë„

```
$ python manage.py sqlmigrate articles 0001

BEGIN;
--
-- Create model Article
--
CREATE TABLE "articles_article" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "title" varchar(10) NOT NULL, "content" text NOT NULL);
COMMIT;
```


#### í•„ë“œê°€ ì¶”ê°€ë˜ì—ˆì„ë•Œ, migrations ê³¼ì •
- ìƒˆë¡œìš´ ì„¤ê³„ë„ë¥¼ ì‘ì„±(makemigrations)í•˜ê³  ì´ë¥¼ DBì— ë°˜ì˜(migrate)

1. model class ì‘ì„± ë° ìˆ˜ì •
ğŸ‘©â€ğŸ’» [model í´ë˜ìŠ¤](./model_practice/articles/models.py)

```py
class Article(models.Model):
    title = models.CharField(max_length=10)
    content = models.TextField()
    # í•„ë“œ ì¶”ê°€
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

2. makemigrations

```
$ python manage.py makemigrations

You are trying to add the field 'created_at' with 'auto_now_add=True' to article without a default; the database needs something to populate existing rows.
<!-- ì´ë¯¸ ê¸°ì¡´ í…Œì´ë¸”ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í•„ë“œë¥¼ ì¶”ê°€ í• ë•Œ í•„ë“œì˜ ê¸°ë³¸ ê°’ ì„¤ì •ì´ í•„ìš” -->

    1) Provied a one-off default now (will be set on all existing rows)
    <!-- ì§ì ‘ ê¸°ë³¸ ê°’ì„ ì…ë ¥ í•˜ëŠ” ë°©ë²• -->
    2) Quit, and let me add a default in models.py
    <!-- í˜„ì¬ ëŒ€í™”ì—ì„œ ë‚˜ê°„ í›„ models.pyì— ê¸°ë³¸ ê°’ ê´€ë ¨ ì„¤ì •ì„ í•˜ëŠ” ë°©ë²• -->
Select an option: 1

Please enter the default value now, as valid Python
You can accept the default 'timezone.now' by pressing 'Enter' or you can provide another value. The datetime and django.utils.timezone modules are available, so you can do e.g. timezone now Type 'exit' to exit this prompt
<!-- 
ì¶”ê°€ í•„ë“œì˜ ê¸°ë³¸ ê°’ì„ ì…ë ¥í•´ì•¼ í•˜ëŠ” ìƒí™© 
ë‚ ì§œ ë°ì´í„°ì´ê¸° ë•Œë¬¸ì— ì§ì ‘ ì…ë ¥ ë³´ë‹¤ëŠ” djangoê°€ ì œì•ˆí•˜ëŠ” ê¸°ë³¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥. ì•„ë¬´ ê²ƒë„ ì…ë ¥í•˜ì§€ ì•Šê³  enterë¥¼ ëˆ„ë¥´ë©´ djangoê°€ ì œì•ˆí•˜ëŠ” ê¸°ë³¸ ê°’ìœ¼ë¡œ ì„¤ì •ë¨
 -->
[default: timezone.now] >>>
```
3. migrate


##### ì™œ? ì²« ë²ˆì§¸ ì„¤ê³„ë„ì— ë®ì–´ì”Œìš°ì§€ ì•Šê³  ë³€ê²½ëœ ë¶€ë¶„ì˜ ì„¤ê³„ë„ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ìŒ“ì•„ë‚˜ê°ˆê¹Œ?
- ì¶”ê°€ëœ migrations íŒŒì¼ì€ ê·¸ ì „ íŒŒì¼ì— ì˜ì¡´ë¨

```py
# articles/migrations/0002_auto_20230328_1431.py

class Migration(migrations.Migration):
    # 0001_initial.pyì— ì˜ì¡´í•¨
    dependencies = [
        ('articles', '0001_initial'),
    ]
```

- commitê³¼ ìœ ì‚¬
- rollbackì„ í•˜ê¸° ìœ„í•´ì„œ
    - 7ë²ˆ ì„¤ê³„ë„ì—ì„œ ë¬¸ì œê°€ ìƒê¸°ë©´ 7ë²ˆ ì„¤ê³„ë„ë¥¼ ì‚­ì œí•˜ê³  6ë²ˆ ì„¤ê³„ë„ë¡œ ë‹¤ì‹œ ì¬êµ¬ì¶•í•˜ë©´ ëœë‹¤.

## Admin site

- Automatic admin interface
    - djangoëŠ” ì¶”ê°€ ì„¤ì¹˜ ë° ì„¤ì • ì—†ì´ ìë™ìœ¼ë¡œ ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ
    - ***ë°ì´í„° ê´€ë ¨ í…ŒìŠ¤íŠ¸ ë° í™•ì¸ì— ìœ ìš©!***

### 1. admin ê³„ì • ìƒì„±

> $ python manage.py createsuperuser

- emailì€ ì„ íƒì‚¬í•­ì´ê¸° ë•Œë¬¸ì— ë¬´ì‹œ ê°€ëŠ¥
- ë¹„ë°€ë²ˆí˜¸ ìƒì„± ì‹œ ë³´ì•ˆìƒ í„°ë¯¸ë„ì— ì¶œë ¥ë˜ì§€ ì•Šìœ¼ë‹ˆ ë¬´ì‹œí•˜ê³  ì…ë ¥ì„ ì´ì–´ê°€ë„ë¡ í•¨.
- ê´€ë¦¬ì ê³„ì •ë„ ìœ ì € í…Œì´ë¸”ì— ì €ì¥ë¨.
- ì£¼ì˜! DBê°€ ìƒì„±ëœ í›„(migrate í•œ í›„)ì— adminì„ ìƒì„±í•´ì•¼ í•¨.
- ë¹„ë°€ë²ˆí˜¸ëŠ” ì•”í˜¸í™”ë˜ì„œ ì €ì¥í•¨. ì¥ê³ ëŠ” ì´ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³µí˜¸í™” í•  ìˆ˜ ìˆëŠ” í‚¤ë¥¼ ê°€ì§€ê³  ìˆìŒ

### 2. admin ë“±ë¡
ğŸ‘©â€ğŸ’» [admin.py](./model_practice/articles/admin.py)

```py
from django.contrib import admin
# ëª…ì‹œì  ìƒëŒ€ ê²½ë¡œ
# í˜„ì¬ ìˆëŠ” modelsì—ì„œ Article í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
from .models import Article 

# Register your models here.
# admin.site.register(ìš°ë¦¬ê°€ ë§Œë“  Article í´ë˜ìŠ¤ë¥¼ ë“±ë¡)
admin.site.register(Article)
```

- admin.pyì— adminì„ ë“±ë¡í•´ì¤˜ì•¼ í•¨.
- ë“±ë¡í•˜ì§€ ì•Šìœ¼ë©´ admin siteì—ì„œ í™•ì¸ í•  ìˆ˜ ì—†ìŒ

## ê¸°ë³¸ ì„¤ì •
ğŸ‘©â€ğŸ’» [settings](./model_practice/curd/settings.py)
```py
# Internationalization
# https://docs.djangoproject.com/en/3.2/topics/i18n/

# LANGUAGE_CODE = 'ko-kr' í•œêµ­ì–´ë¡œ ì„¤ì • ê°€ëŠ¥
LANGUAGE_CODE = 'en-us'

# ê¸°ë³¸ ì‹œê°„ì€ UTC í‘œì¤€ì‹œë¥¼ ë”°ë¥¸ë‹¤. ë§Œì•½ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´ ì¶œë ¥í• ë•Œ ë³€ê²½í•´ì„œ ì‚¬ìš©í•˜ë©´ ë¨.
TIME_ZONE = 'UTC'
```

## ë°ì´í„° ë² ì´ìŠ¤ ì´ˆê¸°í™”

1. migrationsí´ë”ì—ì„œ migration íŒŒì¼ ì‚­ì œ
2. db.sqlite3 íŒŒì¼ ì‚­ì œ

- migrations í´ë” ìì²´ë¥¼ ì‚­ì œí•˜ë©´ ì•ˆë¨.